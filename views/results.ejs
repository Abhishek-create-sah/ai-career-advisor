<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Career Recommendations</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-slate-50 text-gray-800">

    <header class="bg-white shadow-sm">
        <div class="container mx-auto max-w-6xl p-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-indigo-600">Your Personalized Plan</h1>
            <a href="/" class="text-sm font-medium text-indigo-600 hover:text-indigo-800 transition duration-300">← Start Over</a>
        </div>
    </header>

    <main class="container mx-auto max-w-6xl p-4 sm:p-8 my-8">
        <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-800">Hello, <%= userName %>!</h2>
            <p class="text-gray-600 mt-1">Based on your skills, here are your top 3 career recommendations.</p>
        </div>

        <div class="grid lg:grid-cols-3 gap-8 items-start">
            <div class="lg:col-span-2 grid md:grid-cols-2 gap-6">
                <% recommendations.forEach(rec => { %>
                    <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-2xl hover:-translate-y-1 transition-all duration-300 border-t-4 <%= rec.matchPercentage > 75 ? 'border-green-500' : (rec.matchPercentage > 40 ? 'border-yellow-500' : 'border-red-500') %>">
                        
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-xl font-bold text-gray-900"><%= rec.name %></h3>
                            <span class="text-sm font-bold bg-indigo-100 text-indigo-700 px-3 py-1 rounded-full"><%= rec.matchPercentage %>% Match</span>
                        </div>
                        
                        <div class="flex items-center text-sm text-gray-500 mb-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M8.433 7.418c.158-.103.346-.196.567-.267v1.698a2.5 2.5 0 00-.567-.267z" /><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v.092a4.535 4.535 0 00-1.743.557.75.75 0 00.416 1.383c.645-.193 1.32-.226 2.012-.226a2.5 2.5 0 012.5 2.5c0 .926-.394 1.746-1.012 2.288a3.5 3.5 0 00-1.488 2.842.75.75 0 001.5 0c0-.42.118-.832.33-1.204a2.5 2.5 0 001.012-2.288A4.5 4.5 0 0011 5z" clip-rule="evenodd" /></svg>
                            <span><strong>Salary:</strong> <%= rec.salary %></span>
                        </div>
                        <div class="flex items-center text-sm text-gray-500 mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 1.5a.5.5 0 01.5.5v11.586l2.293-2.293a.5.5 0 01.707.707l-3.5 3.5a.5.5 0 01-.707 0l-3.5-3.5a.5.5 0 11.707-.707L11.5 13.586V2a.5.5 0 01.5-.5z" clip-rule="evenodd" /></svg>
                            <span><strong>Growth:</strong> <%= rec.growth %></span>
                        </div>

                        <div class="space-y-4 text-sm">
                            <p><strong class="text-green-600">Your Skills:</strong> <span class="text-gray-600"><%= rec.matchedSkills.join(', ') || 'None' %></span></p>
                            <p><strong class="text-red-600">To Develop:</strong> <span class="text-gray-600"><%= rec.skillGap.join(', ') || 'None' %></span></p>
                        </div>
                        
                        <% if (rec.learningRoadmap.length > 0) { %>
                        <div class="mt-4 border-t pt-4">
                            <h4 class="font-semibold text-sm text-gray-800 mb-2">Learning Roadmap:</h4>
                            <ul class="space-y-2">
                                <% rec.learningRoadmap.forEach(step => { %>
                                    <li class="flex text-xs">
                                        <span class="text-indigo-500 mr-2">✓</span>
                                        <div class="text-gray-600">
                                            <strong><%= step.skill %>:</strong> <%= step.resource %> (<em class="text-gray-500"><%= step.timeline %></em>)
                                        </div>
                                    </li>
                                <% }); %>
                            </ul>
                        </div>
                        <% } %>

                        <% if (rec.marketInsights) { %>
                        <div class="mt-4 border-t pt-4">
                            <h4 class="font-semibold text-sm text-gray-800 mb-2">Job Market Insights (India):</h4>
                            <div class="space-y-2 text-xs">
                                <p><strong class="text-gray-700">Demand:</strong> <span class="font-bold <%= rec.marketInsights.demand.includes('High') ? 'text-green-600' : 'text-yellow-600' %>"><%= rec.marketInsights.demand %></span></p>
                                <div class="flex flex-wrap gap-1">
                                    <% rec.marketInsights.topCities.forEach(city => { %>
                                        <span class="bg-slate-100 text-slate-700 px-2 py-0.5 rounded"><%= city %></span>
                                    <% }); %>
                                </div>
                            </div>
                        </div>
                        <% } %>
                    </div>
                <% }); %>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-lg sticky top-8">
                <h3 class="text-lg font-bold text-center mb-4">Skill Analysis for <br> <span class="text-indigo-600"><%= recommendations[0].name %></span></h3>
                <canvas id="skillGapChart"></canvas>
            </div>
        </div>
    </main>
    
    <script>
        const topRecommendation = <%- JSON.stringify(recommendations[0]) %>;
        const ctx = document.getElementById('skillGapChart').getContext('2d');
        const skillGapChart = new Chart(ctx, { type: 'radar', data: { labels: topRecommendation.required, datasets: [{ label: 'Your Skill Level', data: topRecommendation.required.map(skill => topRecommendation.matchedSkills.includes(skill) ? 100 : 20), backgroundColor: 'rgba(79, 70, 229, 0.2)', borderColor: 'rgba(79, 70, 229, 1)', borderWidth: 2 }] }, options: { scales: { r: { angleLines: { display: false }, suggestedMin: 0, suggestedMax: 100, pointLabels: { font: { size: 12 } }, ticks: { display: false } } }, plugins: { legend: { display: false } } } });
    </script>
</body>
</html>